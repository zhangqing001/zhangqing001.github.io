
 <!DOCTYPE HTML>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  
    <title>Docker for MySQL deployment | sunny&#39;s Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="qing.zhang">
    

    
    <meta name="description" content="Use Docker for MySQL deployment

Docker is an open platform for developers and sysadmins to build, ship, and run distributed applications, whether on laptops, data center VMs, or the cloudsee the deta">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker for MySQL deployment">
<meta property="og:url" content="http://yoursite.com/2014/12/12/docker for mysql/">
<meta property="og:site_name" content="sunny's Blog">
<meta property="og:description" content="Use Docker for MySQL deployment

Docker is an open platform for developers and sysadmins to build, ship, and run distributed applications, whether on laptops, data center VMs, or the cloudsee the deta">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Docker for MySQL deployment">
<meta name="twitter:description" content="Use Docker for MySQL deployment

Docker is an open platform for developers and sysadmins to build, ship, and run distributed applications, whether on laptops, data center VMs, or the cloudsee the deta">
<meta name="twitter:creator" content="@ruiaylin">


    
    <link rel="alternative" href="/atom.xml" title="sunny&#39;s Blog" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css" type="text/css">

</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="sunny&#39;s Blog" title="sunny&#39;s Blog"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="sunny&#39;s Blog">sunny&#39;s Blog</a></h1>
				<h2 class="blog-motto">蹈之而弗悔 ,  慎思而笃行  ...</h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="菜单">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home|主页</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="搜索" />
						<input type="hidden" name="q" value="site:yoursite.com">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2014/12/12/docker for mysql/" title="Docker for MySQL deployment" itemprop="url">Docker for MySQL deployment</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="qing.zhang" target="_blank" itemprop="author">qing.zhang</a>
		
  <p class="article-time">
    <time datetime="2014-12-12T08:50:53.000Z" itemprop="datePublished"> 发表于 12月 12 2014</time>
    
  </p>
</header>
	<div class="article-content">
		
		<div id="toc" class="toc-article">
			<strong class="toc-title">文章目录</strong>
		
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Use_Docker_for_MySQL_deployment"><span class="toc-number">1.</span> <span class="toc-text">Use Docker for MySQL deployment</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OS_environment"><span class="toc-number">2.</span> <span class="toc-text">OS environment</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Run_software_updates:"><span class="toc-number">2.1.</span> <span class="toc-text">Run software updates:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#install_EPEL_repository"><span class="toc-number">2.2.</span> <span class="toc-text">install EPEL repository</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Install_Docker_Tools"><span class="toc-number">2.3.</span> <span class="toc-text">Install Docker Tools</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Start_Docker_as_service"><span class="toc-number">2.4.</span> <span class="toc-text">Start Docker as service</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Configure_Docker_to_start_on_startup"><span class="toc-number">2.5.</span> <span class="toc-text">Configure Docker to start on startup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#check_docker_service"><span class="toc-number">2.6.</span> <span class="toc-text">check docker service</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#install_Docker_done"><span class="toc-number">2.7.</span> <span class="toc-text">install Docker done</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Make_a_docker_images"><span class="toc-number">3.</span> <span class="toc-text">Make a docker images</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#frist_download_percona_mysql_rpms"><span class="toc-number">3.1.</span> <span class="toc-text">frist download percona mysql rpms</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#make_a_docker_file"><span class="toc-number">3.2.</span> <span class="toc-text">make a docker file</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#build_the_image"><span class="toc-number">3.3.</span> <span class="toc-text">build the image</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#push_image"><span class="toc-number">3.4.</span> <span class="toc-text">push image</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#use_exsiting_image"><span class="toc-number">4.</span> <span class="toc-text">use exsiting image</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#download_image"><span class="toc-number">4.1.</span> <span class="toc-text">download image</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#run_container_after_download"><span class="toc-number">4.2.</span> <span class="toc-text">run container after download</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#run_like_shell"><span class="toc-number">4.2.1.</span> <span class="toc-text">run like shell</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#run_like_a_tool"><span class="toc-number">4.2.2.</span> <span class="toc-text">run like a tool</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#get_container_ip_:"><span class="toc-number">4.3.</span> <span class="toc-text">get container ip :</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#make_image_use_container"><span class="toc-number">4.4.</span> <span class="toc-text">make image use container</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary"><span class="toc-number">5.</span> <span class="toc-text">summary</span></a></li></ol>
		
		</div>
		
		<h2 id="Use_Docker_for_MySQL_deployment">Use Docker for MySQL deployment</h2>
<blockquote>
<p>Docker is an open platform for developers and sysadmins to build, ship, and run distributed applications, whether on laptops, data center VMs, or the cloud<br>see the details :<a href="https://www.docker.com/whatisdocker/" target="_blank" rel="external">https://www.docker.com/whatisdocker/</a></p>
</blockquote>
<h2 id="OS_environment">OS environment</h2>
<blockquote>
<p>CentOs 6.6 newest version </p>
</blockquote>
<h3 id="Run_software_updates:">Run software updates:</h3>
<pre><code><span class="built_in">sudo</span> <span class="operator">-s</span>
yum update -y
yum install -y wget git
</code></pre><h3 id="install_EPEL_repository">install EPEL repository</h3>
<p>Enable EPEL repository so you can install some extra packages:</p>
<pre><code><span class="title">cd</span> /tmp
wget <span class="url">http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm</span>
sudo rpm -Uvh epel-release-<span class="number">6</span><span class="regexp">*.rpm</span>
</code></pre><h3 id="Install_Docker_Tools">Install Docker Tools</h3>
<pre><code><span class="built_in">sudo</span> yum -y install docker-io
</code></pre><h3 id="Start_Docker_as_service">Start Docker as service</h3>
<pre><code><span class="built_in">sudo</span> service docker start
</code></pre><h3 id="Configure_Docker_to_start_on_startup">Configure Docker to start on startup</h3>
<pre><code>sudo chkconfig docker <span class="command"><span class="keyword">on</span></span>
</code></pre><h3 id="check_docker_service">check docker service</h3>
<pre><code><span class="title">service</span> docker status 
docker <span class="built_in">info</span> 
docker images 
docker ps 
</code></pre><h3 id="install_Docker_done">install Docker done</h3>
<pre><code><span class="built_in">Now</span> the docker enviorement <span class="keyword">is</span> ready 
</code></pre><h2 id="Make_a_docker_images">Make a docker images</h2>
<blockquote>
<p>you can download my images build for percona server at next section </p>
</blockquote>
<h3 id="frist_download_percona_mysql_rpms">frist download percona mysql rpms</h3>
<pre><code><span class="title">mkdir</span> /<span class="typedef"><span class="keyword">data</span>/docker/repos -p </span>
<span class="title">cd</span> /<span class="typedef"><span class="keyword">data</span>/docker/repos</span>
<span class="title">wget</span> http://www.percona.com/downloads/<span class="type">Percona</span>-<span class="type">Server</span>-<span class="number">5.6</span>/<span class="type">Percona</span>-<span class="type">Server</span>-<span class="number">5.6</span><span class="number">.21</span>-<span class="number">70.0</span>/binary/redhat/<span class="number">6</span>/x86_64/<span class="type">Percona</span>-<span class="type">Server</span>-<span class="number">5.6</span><span class="number">.21</span>-<span class="number">70.0</span>-r688-el6-x86_64-bundle.tar
<span class="title">cd</span> ../
</code></pre><h3 id="make_a_docker_file">make a docker file</h3>
<pre><code># MySQL 
# <span class="operator"><span class="keyword">use</span> centos base image
<span class="keyword">FROM</span> centos:centos6
# specify the maintainer
MAINTAINER ruiayliln <span class="string">"ruiaylin@gmail.com"</span>
# <span class="keyword">update</span> <span class="keyword">get</span> mysql tars repos
RUN yum <span class="keyword">install</span> -y wget tar 
RUN yum <span class="keyword">install</span> -y perl-libs perl perl-DBD-MySQL perl-DBI perl-<span class="keyword">Module</span>-Pluggable  perl-Pod-Escapes  perl-Pod-Simple perl-<span class="keyword">Time</span>-HiRes perl-IO-Socket-SSL
RUN yum <span class="keyword">install</span> -y libaio screen   
RUN yum <span class="keyword">install</span> -y python-setuptools 
# scp file 
<span class="keyword">ADD</span>  repos/Percona-<span class="keyword">Server</span>-<span class="number">5.6</span><span class="number">.21</span>-<span class="number">70.0</span>-r688-el6-x86_64-bundle.tar  /tmp/
# <span class="keyword">install</span> <span class="keyword">some</span> dependencies
RUN ls -al /tmp/
# <span class="keyword">install</span> 
RUN rpm -ivh /tmp/Percona-<span class="keyword">Server</span>-shared-<span class="number">56</span>-<span class="number">5.6</span><span class="number">.21</span>-rel70<span class="number">.0</span>.el6.x86_64.rpm
RUN rpm -ivh /tmp/Percona-<span class="keyword">Server</span>-devel-<span class="number">56</span>-<span class="number">5.6</span><span class="number">.21</span>-rel70<span class="number">.0</span>.el6.x86_64.rpm
RUN rpm -ivh /tmp/Percona-<span class="keyword">Server</span>-<span class="number">56</span>-debuginfo-<span class="number">5.6</span><span class="number">.21</span>-rel70<span class="number">.0</span>.el6.x86_64.rpm
RUN rpm -ivh /tmp/Percona-<span class="keyword">Server</span>-client-<span class="number">56</span>-<span class="number">5.6</span><span class="number">.21</span>-rel70<span class="number">.0</span>.el6.x86_64.rpm
#configure /etc/file 
<span class="keyword">ADD</span> my.cnf /etc/
RUN rpm -ivh /tmp/Percona-<span class="keyword">Server</span>-<span class="keyword">server</span>-<span class="number">56</span>-<span class="number">5.6</span><span class="number">.21</span>-rel70<span class="number">.0</span>.el6.x86_64.
# <span class="keyword">check</span> mysql <span class="keyword">version</span>
RUN mysql -V
RUN mysqld  -V  
# python-setuptools 
RUN /usr/sbin/mysqld &amp; \
    <span class="keyword">sleep</span> <span class="number">10</span>s &amp;&amp;\
    echo <span class="string">" grant all privileges on *.* to admin@'localhost' identified by 'studytest' with grant option;grant all privileges on *.* to admin@'127.0.0.1' identified by 'studytest' with grant option;grant all privileges on *.* to opsdba@'%' identified by 'studytest' ;grant REPLICATION SLAVE,REPLICATION CLIENT ON *.* TO 'replication'@'%' IDENTIFIED BY 'studytest';grant SELECT,CREATE,DROP,PROCESS,FILE,INDEX,ALTER,SUPER,LOCK TABLES ON *.* TO 'mtain'@'%' IDENTIFIED BY 'studytest';  flush privileges;"</span> | mysql   
# expose mysqld port
EXPOSE <span class="number">3306</span>  

CMD [<span class="string">"/usr/bin/mysqld_safe"</span>]</span>
</code></pre><h3 id="build_the_image">build the image</h3>
<pre><code>docker build -t ruiaylin/percona56-gtid-sid1  .
</code></pre><h3 id="push_image">push image</h3>
<blockquote>
<p>register :  <a href="https://index.docker.io/account/signup/" target="_blank" rel="external">https://index.docker.io/account/signup/</a><br>input username  &amp;&amp; password when you push image  </p>
</blockquote>
<p>push：</p>
<pre><code>docker <span class="keyword">push</span> ruiaylin/percona56-gtid-sid1:v1
docker <span class="keyword">push</span> ruiaylin/percona56-gtid-sid2:v1
</code></pre><p>check ： </p>
<pre><code>[root<span class="variable">@mytestdb01</span> ~]<span class="comment"># docker search ruiaylin/percona56-gtid-sid </span>
<span class="constant">NAME</span>                           <span class="constant">DESCRIPTION</span>    <span class="constant">STARS</span>     <span class="constant">OFFICIAL</span>   <span class="constant">AUTOMATED</span>
ruiaylin/percona56-gtid-sid1   percona5.<span class="number">6</span>s1   <span class="number">1</span>                    
ruiaylin/percona56-gtid-sid2   percona5.<span class="number">6</span>     <span class="number">1</span>    
</code></pre><h2 id="use_exsiting_image">use exsiting image</h2>
<blockquote>
<p>download percona mysql server for our envirament </p>
</blockquote>
<h3 id="download_image">download image</h3>
<pre><code>docker search ruiaylin/percona56-gtid-sid
<span class="preprocessor">#download  </span>
docker pull ruiaylin/percona56-gtid-sid2:v1
docker pull ruiaylin/percona56-gtid-sid1:v1 
</code></pre><h3 id="run_container_after_download">run container after download</h3>
<pre><code>docker images 
[root@mytestdb01 ~]<span class="comment"># docker images</span>
REPOSITORY                     TAG                 IMAGE ID            CREATED                  VIRTUAL SIZE
ruiaylin/percona56-gtid-sid2   v1                  <span class="number">44754483</span>adfa        <span class="operator">Less</span> than a second ago   <span class="number">1.463</span> GB
ruiaylin/percona56-gtid-sid1   v1                  <span class="number">78</span>eaac9dbe1e        <span class="operator">Less</span> than a second ago   <span class="number">1.484</span> GB
</code></pre><h4 id="run_like_shell">run like shell</h4>
<p>command :<br>        docker run -it ruiaylin/percona56-gtid-sid1:v1  /bin/bash</p>
<p>like  : </p>
<pre><code>[root<span class="variable">@mytestdb01</span> ~]<span class="comment"># docker run -it ruiaylin/percona56-gtid-sid1:v1  /bin/bash</span>
[root<span class="variable">@9ed2b3dc0f5f</span> /]<span class="comment"># </span>
[root<span class="variable">@9ed2b3dc0f5f</span> /]<span class="comment"># </span>
[root<span class="variable">@9ed2b3dc0f5f</span> /]<span class="comment"># </span>
[root<span class="variable">@9ed2b3dc0f5f</span> /]<span class="comment"># mysqld_safe &amp;</span>
[<span class="number">1</span>] <span class="number">14</span>
[root<span class="variable">@9ed2b3dc0f5f</span> /]<span class="comment"># 141223 02:17:47 mysqld_safe Logging to '/data/mysql3306/log/alert.log'.</span>
<span class="number">141223</span> <span class="number">02</span><span class="symbol">:</span><span class="number">17</span><span class="symbol">:</span><span class="number">47</span> mysqld_safe <span class="constant">Starting</span> mysqld daemon with databases from /data/mysql3306/data
</code></pre><blockquote>
<p>if you execute  exit command , the container is stop , if you want keep the container running , use Ctrl + p ; Ctrl + q  to exit the termail .<br>you can start Several container , use the same command , one ip per container .</p>
</blockquote>
<h4 id="run_like_a_tool">run like a tool</h4>
<p>command : </p>
<pre><code>docker run -it ruiaylin<span class="regexp">/percona56-gtid-sid1:v1  /</span>usr<span class="regexp">/bin/m</span>ysqld_safe
</code></pre><p>log like this : </p>
<pre><code>[root@mytestdb01 ~]<span class="comment"># docker run -it ruiaylin/percona56-gtid-sid1:v1  /usr/bin/mysqld_safe </span>
<span class="number">141223</span> <span class="number">02</span>:<span class="number">27</span>:<span class="number">27</span> mysqld_safe Logging <span class="keyword">to</span> '/data/mysql3306/<span class="command">log</span>/alert.<span class="command">log</span>'.
<span class="number">141223</span> <span class="number">02</span>:<span class="number">27</span>:<span class="number">27</span> mysqld_safe Starting mysqld daemon <span class="keyword">with</span> databases <span class="keyword">from</span> /data/mysql3306/data
[root@mytestdb01 ~]<span class="comment"># </span>
</code></pre><blockquote>
<p>use Ctrl + p ; Ctrl + q  to exit the terminal </p>
</blockquote>
<h3 id="get_container_ip_:">get container ip :</h3>
<p>use docker inspect command to get the env :</p>
<pre><code>[root@mytestdb01 ~]# for x in <span class="smartquote">`  docker ps | grep -v CONTAINER | awk  '</span>{print $1}'   <span class="smartquote">`; do   ip=`docker inspect -f '</span>[[ .NetworkSettings.IPAddress ]]' $x `;echo $x:$ip  ; done
ecb06307f126:172.17.0.7
74dc6520fb70:172.17.0.6
9ed2b3dc0f5f:172.17.0.5
</code></pre><blockquote>
<p> [[ should change to {{ ， when you execute the command above .</p>
</blockquote>
<h3 id="make_image_use_container">make image use container</h3>
<pre><code><span class="title">docker</span> commit -a <span class="string">"ruiaylin  &lt;ruiaylin<span class="variable">@gmail</span>.com &gt;"</span>  0087e76555d2  ruiaylin/percona56-gtid-sid1:v2
</code></pre><h2 id="summary">summary</h2>
<pre><code><span class="keyword">now</span> , you mysql environment <span class="keyword">for</span> study <span class="keyword">or</span> testing <span class="keyword">is</span> done , enjoy it buddy ....
</code></pre>  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/docker/">docker</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/mysql/">mysql</a><a href="/tags/docker/">docker</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://yoursite.com/2014/12/12/docker for mysql/" data-title="Docker for MySQL deployment | sunny&#39;s Blog" data-tsina="undefined" class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev" >
 <a href="/2015/01/05/deploy a forum using  discourse/" title="How To Install Discourse On CentOS 6.x">
  <strong>上一篇：</strong><br/>
  <span>
  How To Install Discourse On CentOS 6.x</span>
</a>
</div>


<div class="next">
<a href="/2014/12/12/python update/"  title="CentOs 6.x 升级 Python 版本">
 <strong>下一篇：</strong><br/> 
 <span>CentOs 6.x 升级 Python 版本
</span>
</a>
</div>

</nav>

	

</div>  
      <div class="openaside"><a class="navbutton" href="#" title="显示侧边栏"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">文章目录</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Use_Docker_for_MySQL_deployment"><span class="toc-number">1.</span> <span class="toc-text">Use Docker for MySQL deployment</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#OS_environment"><span class="toc-number">2.</span> <span class="toc-text">OS environment</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Run_software_updates:"><span class="toc-number">2.1.</span> <span class="toc-text">Run software updates:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#install_EPEL_repository"><span class="toc-number">2.2.</span> <span class="toc-text">install EPEL repository</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Install_Docker_Tools"><span class="toc-number">2.3.</span> <span class="toc-text">Install Docker Tools</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Start_Docker_as_service"><span class="toc-number">2.4.</span> <span class="toc-text">Start Docker as service</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Configure_Docker_to_start_on_startup"><span class="toc-number">2.5.</span> <span class="toc-text">Configure Docker to start on startup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#check_docker_service"><span class="toc-number">2.6.</span> <span class="toc-text">check docker service</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#install_Docker_done"><span class="toc-number">2.7.</span> <span class="toc-text">install Docker done</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Make_a_docker_images"><span class="toc-number">3.</span> <span class="toc-text">Make a docker images</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#frist_download_percona_mysql_rpms"><span class="toc-number">3.1.</span> <span class="toc-text">frist download percona mysql rpms</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#make_a_docker_file"><span class="toc-number">3.2.</span> <span class="toc-text">make a docker file</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#build_the_image"><span class="toc-number">3.3.</span> <span class="toc-text">build the image</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#push_image"><span class="toc-number">3.4.</span> <span class="toc-text">push image</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#use_exsiting_image"><span class="toc-number">4.</span> <span class="toc-text">use exsiting image</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#download_image"><span class="toc-number">4.1.</span> <span class="toc-text">download image</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#run_container_after_download"><span class="toc-number">4.2.</span> <span class="toc-text">run container after download</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#run_like_shell"><span class="toc-number">4.2.1.</span> <span class="toc-text">run like shell</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#run_like_a_tool"><span class="toc-number">4.2.2.</span> <span class="toc-text">run like a tool</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#get_container_ip_:"><span class="toc-number">4.3.</span> <span class="toc-text">get container ip :</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#make_image_use_container"><span class="toc-number">4.4.</span> <span class="toc-text">make image use container</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#summary"><span class="toc-number">5.</span> <span class="toc-text">summary</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="隐藏侧边栏"></a></div>
<aside class="clearfix">

  
<div class="github-card">
<p class="asidetitle">Github 名片</p>
<div class="github-card" data-github="ruiaylin" data-width="220" data-height="119" data-theme="medium">
<script type="text/javascript" src="//cdn.jsdelivr.net/github-cards/latest/widget.js" ></script>
</div>
  </div>



  
<div class="categorieslist">
	<p class="asidetitle">分类</p>
		<ul>
		
		  
			<li><a href="/categories/MySQL/" title="MySQL">MySQL<sup>12</sup></a></li>
		  
		
		  
			<li><a href="/categories/docker/" title="docker">docker<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/linux/" title="linux">linux<sup>4</sup></a></li>
		  
		
		  
			<li><a href="/categories/oracle/" title="oracle">oracle<sup>2</sup></a></li>
		  
		
		  
			<li><a href="/categories/python/" title="python">python<sup>7</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">标签</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/mysql/" title="mysql">mysql<sup>5</sup></a></li>
			
		
			
				<li><a href="/tags/fabric/" title="fabric">fabric<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/python/" title="python">python<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/ops/" title="ops">ops<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/mha/" title="mha">mha<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/xtrabackup/" title="xtrabackup">xtrabackup<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/docker/" title="docker">docker<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/sharding/" title="sharding">sharding<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/DNS/" title="DNS">DNS<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/code/" title="code">code<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/源码/" title="源码">源码<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/多实例/" title="多实例">多实例<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/autofailover/" title="autofailover">autofailover<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/shell/" title="shell">shell<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/DLZ/" title="DLZ">DLZ<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/BIND/" title="BIND">BIND<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/load-data/" title="load-data">load-data<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/tools/" title="tools">tools<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/optimization/" title="optimization">optimization<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/pssh/" title="pssh">pssh<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">友情链接</p>
    <ul>
        
          <li>
            
            	<a href="http://flask.pocoo.org/" target="_blank" title="Flask Documentation">Flask Docs</a>
            
          </li>
        
          <li>
            
            	<a href="http://tympanus.net/codrops/ " target="_blank" title=" front end development">Codrops</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS 订阅</a>
</div>

</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> I&#39;m ruiayLin , work at AUTOHOME.COM.CN   <br/>
			Previous : work at Alipay.com as a database engineer for three years </p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		
		<a href="https://github.com/ruiaylin" target="_blank" class="icon-github" title="github"></a>
		
		
		
		<a href="https://twitter.com/ruiaylin" target="_blank" class="icon-twitter" title="twitter"></a>
		
		
		<a href="https://www.facebook.com/ruiayLin" target="_blank" class="icon-facebook" title="facebook"></a>
		
		
		<a href="https://www.linkedin.com/in/ruichao-lin-5713624a" target="_blank" class="icon-linkedin" title="linkedin"></a>
		
		
		
		
		
		<a href="mailto:ruiaylin@gmail.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2016 
		
		<a href="/about" target="_blank" title="qing.zhang">qing.zhang</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>









<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="返回顶部"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
